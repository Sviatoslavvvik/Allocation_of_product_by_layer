# Allocation_of_product_by_layer
Тестовое задание Аллокация добычи по пластам

Задание выполнено на python, в качестве БД используется sqlite3
примененные библиотеки sqlite3, pandas, json

## Установка и запуск

1. Склонировать репозиторий с Github:
````
git clone https://github.com/Sviatoslavvvik/Allocation_of_product_by_layer.git
````
2. Перейти в директорию проекта
3. Создать виртуальное окружение:

````
python -m venv venv
````
4. Активировать окружение: 
````
source\venv\bin\activate
````
или для windows

````
source\venv\scripts\activate
````
6. Установка зависимостей:

```
pip install -r requirements.txt
```
**Техзадание:** 
Исходные данные - excel файл well_data.xlsx.
На первом листе rates представлены данные добычи продукции по скважинам (well_id) за интервал в 10 суток. Нефть – oil_rate, вода – water_rate, газ – gas_rate.
На втором листе splits – доля добычи тех же скважин (well_id) по пластам (layer_id), выраженная в процентах. Нефть – oil_split, вода – water_split, газ – gas_split. Значения этих коэффициентов (сплитов) могут изменяться ото дня ко дню, набор пластов для скважины также может изменяться.
Третий лист invalid_splits – копия второго с ошибками в заполнении данных.

## Задача 1
Сумма сплитов по одной скважине на одну дату по конкретному типу флюида (нефть, вода, газ) должна быть равна 100% для заданных пластов.
Необходимо по данным третьего листа invalid_splits определить и записать список скважин, соответствующие даты и тип флюида, где сумма сплитов не равняется 100%.

### Решение : split_validation.py

## Задача 2
Для каждого пласта в каждой строчке таблицы сплитов (2 лист splits) посчитать соответствующий расход каждого флюида (нефть, вода, газ) по формуле
split_rate = rate * split / 100
Значения расходов (rate) брать из таблицы на 1 листе rates по well_id и dt
Результаты второй задачи сохранить в виде excel файла, а также в json файл следующего формата. Названия полей в camelCase, даты со временем в ISO формате.
### Решение : calculate_allocation.py